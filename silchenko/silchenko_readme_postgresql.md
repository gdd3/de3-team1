# de3-team1-silchenko PostgreSQL
### 1. Установка PostgreSQL:
#### 1.1. Импортируем PostgreSQL public GPG key:
       wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
#### 1.2. Выполняем команду и запоминаем результат:
       lsb_release -cs
#### 1.3. Создаём файл /etc/apt/sources.list.d/pgdg.list:
       sudo vi /etc/apt/sources.list.d/pgdg.list
#### 1.4. Помещаем туда строчку, подставив результат команды из шага 1.2.:
       deb http://apt.postgresql.org/pub/repos/apt/  результат команды-pgdg main
      Пример:
       deb http://apt.postgresql.org/pub/repos/apt/ xenial-pgdg main
#### 1.5. Обновляем репозиторий:
       sudo apt-get update
#### 1.6. Устанавливаем PostgreSQL:
       sudo apt-get install postgresql-10 pgadmin4

### 2. Создание пользователя, базы данных и таблицы:
#### 2.1. Создание пользователя:
       sudo -u postgres createuser --interactive
#### 2.2. Создание базы данных (меняем на свою):
       sudo -u postgres createdb loveflorida88
#### 2.3. Задаём пароль позователю (меняем на своего пользователя и на свой пароль):
       alter user loveflorida88 with password 'пароль';
#### 2.4. Создание таблицы (меняем на свою):
```sql
CREATE TABLE SILCHENKO (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ingested_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    annotation TEXT,
    name TEXT,
    author TEXT,
    itemid TEXT,
    parent_id TEXT,
    rating TEXT,
    catalogid TEXT,
    catalogpath TEXT
);
```
#### 2.5. Создание и загрузка таблицы рейтингов (меняем на свою):
```sql
CREATE TABLE RATINGS (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ingested_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    data jsonb NOT NULL
);
CREATE INDEX RATINGS_GIN_IDX ON RATINGS USING GIN(data);
```
      Загрузка:
       cat ratings_original.json | psql -h localhost -p 5432 loveflorida88 -c "COPY ratings (data) FROM STDIN;"
